# src/Resources/config/services.yaml
services:
    _defaults:
        autowire: true
        autoconfigure: true

    # ------------------------------------------------------
    # Plugin services
    # ------------------------------------------------------
    Rika\SyliusBrandPlugin\:
        resource: '../../*'
        exclude: '../../{DependencyInjection,Entity,Tests}'

    # ------------------------------------------------------
    # Controllers
    # ------------------------------------------------------
    Rika\SyliusBrandPlugin\Controller\:
        resource: '../../Controller'
        tags: ['controller.service_arguments']

    # ------------------------------------------------------
    # EventListeners
    # ------------------------------------------------------
    Rika\SyliusBrandPlugin\EventListener\BrandEventListener:
        arguments:
            $uploadDir: '%kernel.project_dir%/public/uploads/brands'
        tags:
            - { name: kernel.event_listener, event: 'sylius.brand.pre_create', method: uploadLogo }
            - { name: kernel.event_listener, event: 'sylius.brand.pre_update', method: uploadLogo }

    Rika\SyliusBrandPlugin\EventListener\ProductMappingListener:
        tags:
            - { name: doctrine.event_listener, event: loadClassMetadata }

    # ------------------------------------------------------
    # Menu
    # ------------------------------------------------------
    Rika\SyliusBrandPlugin\Menu\AdminMenuListener:
        tags:
            - { name: kernel.event_listener, event: sylius.menu.admin.main, method: addBrandMenu }

    # ------------------------------------------------------
    # Forms
    # ------------------------------------------------------
    Rika\SyliusBrandPlugin\Form\Type\:
        resource: '../../Form/Type'
        tags: ['form.type']

    Rika\SyliusBrandPlugin\Form\Extension\:
        resource: '../../Form/Extension'
        tags: ['form.type_extension']

    Rika\SyliusBrandPlugin\EventListener\ProductBrandListener:
        tags:
            - { name: doctrine.event_subscriber }